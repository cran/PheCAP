<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Example 1: Simulated Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example 1: Simulated Data</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(PheCAP)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a></code></pre></div>
<p>Generate simulated data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">latent &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">latent2 &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">ehr_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">patient_id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8000</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">ICD1 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">7</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span>latent) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">ICD2 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">6</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span>latent) <span class="op">/</span><span class="st"> </span><span class="fl">1.1</span>),</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="dt">ICD3 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>latent2) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">ICD4 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="dt">NLP1 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">8</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span>latent) <span class="op">/</span><span class="st"> </span><span class="fl">0.6</span>),</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  <span class="dt">NLP2 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">1.1</span>) <span class="op">+</span><span class="st"> </span>latent) <span class="op">/</span><span class="st"> </span><span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  <span class="dt">NLP3 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">5</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span>latent) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  <span class="dt">NLP4 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">11</span> <span class="op">*</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">1.9</span> <span class="op">+</span><span class="st"> </span>latent) <span class="op">/</span><span class="st"> </span><span class="fl">1.9</span>),</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  <span class="dt">NLP5 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>latent2) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  <span class="dt">NLP6 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  <span class="dt">NLP7 =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  <span class="dt">HU =</span> <span class="kw">rpois</span>(<span class="dv">8000</span>, <span class="dv">30</span> <span class="op">*</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">8000</span>, <span class="fl">0.1</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  <span class="dt">label =</span> <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">ii &lt;-<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">8000</span>, <span class="dv">400</span>)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">ehr_data[ii, <span class="st">&quot;label&quot;</span>] &lt;-<span class="st"> </span><span class="kw">with</span>(</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  ehr_data[ii, ], <span class="kw">rbinom</span>(<span class="dv">400</span>, <span class="dv">1</span>, <span class="kw">plogis</span>(</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">    <span class="dv">-5</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">log1p</span>(ICD1) <span class="op">+</span><span class="st"> </span><span class="kw">log1p</span>(NLP1) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="st">      </span><span class="fl">0.8</span> <span class="op">*</span><span class="st"> </span><span class="kw">log1p</span>(NLP3) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">log1p</span>(HU))))</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="kw">head</span>(ehr_data)</a></code></pre></div>
<pre><code>##   patient_id ICD1 ICD2 ICD3 ICD4 NLP1 NLP2 NLP3 NLP4 NLP5 NLP6 NLP7  HU label
## 1          1    2   11    3    0    0    2    2    2    1    7    0   4    NA
## 2          2    5   11    3    1    5    0    1   11    5    0    0   0    NA
## 3          3   17   10    0    2   20    2   16   10    0    0    2   0    NA
## 4          4    0    5    0    0    0    0    0   15    3    3    7   0    NA
## 5          5    0    5    1    0    0    3    7    6   31    0    3 146    NA
## 6          6    4   11    4    0   13    2    3    4    2    3    0   0    NA</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">tail</span>(ehr_data)</a></code></pre></div>
<pre><code>##      patient_id ICD1 ICD2 ICD3 ICD4 NLP1 NLP2 NLP3 NLP4 NLP5 NLP6 NLP7 HU label
## 7995       7995    9   23    0    7   11    4    1   17    4    0    0  1    NA
## 7996       7996   21    7    9    0    6    1    1    6    4    1    2 11    NA
## 7997       7997   26    0    0    1    0    1    0   10    3    0    3  0    NA
## 7998       7998    3    0    5    1   34    1    5   21    4    4    1 46     0
## 7999       7999    0    0    0    0    4    0    0    5    0    0    5  0    NA
## 8000       8000    0    4    0    0    0   14    1    3    0    4    2  9    NA</code></pre>
<p>Define features and labels used for phenotyping.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw">PhecapData</span>(ehr_data, <span class="st">&quot;HU&quot;</span>, <span class="st">&quot;label&quot;</span>, <span class="fl">0.4</span>, <span class="dt">patient_id =</span> <span class="st">&quot;patient_id&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">data</a></code></pre></div>
<pre><code>## PheCAP Data
## Feature: 8000 observations of 12 variables
## Label: 132 yes, 268 no, 7600 missing
## Size of training samples: 240
## Size of validation samples: 160</code></pre>
<p>Specify the surrogate used for surrogate-assisted feature extraction (SAFE). The typical way is to specify a main ICD code, a main NLP CUI, as well as their combination. The default lower_cutoff is 1, and the default upper_cutoff is 10. In some cases one may want to define surrogate through lab test. Feel free to change the cutoffs based on domain knowledge.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">surrogates &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="kw">PhecapSurrogate</span>(</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">    <span class="dt">variable_names =</span> <span class="st">&quot;ICD1&quot;</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="dt">lower_cutoff =</span> <span class="dv">1</span>, <span class="dt">upper_cutoff =</span> <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="kw">PhecapSurrogate</span>(</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    <span class="dt">variable_names =</span> <span class="st">&quot;NLP1&quot;</span>,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="dt">lower_cutoff =</span> <span class="dv">1</span>, <span class="dt">upper_cutoff =</span> <span class="dv">10</span>))</a></code></pre></div>
<p>Run surrogate-assisted feature extraction (SAFE) and show result.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">system.time</span>(feature_selected &lt;-<span class="st"> </span><span class="kw">phecap_run_feature_extraction</span>(data, surrogates))</a></code></pre></div>
<pre><code>##    user  system elapsed 
##  10.300   0.000  10.303</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">feature_selected</a></code></pre></div>
<pre><code>## Feature(s) selected by surrogate-assisted feature extraction (SAFE)
## [1] &quot;ICD1&quot; &quot;ICD2&quot; &quot;NLP1&quot; &quot;NLP2&quot; &quot;NLP3&quot;</code></pre>
<p>Train phenotyping model and show the fitted model, with the AUC on the training set as well as random splits.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">suppressWarnings</span>(model &lt;-<span class="st"> </span><span class="kw">phecap_train_phenotyping_model</span>(data, surrogates, feature_selected))</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">model</a></code></pre></div>
<pre><code>## Phenotyping model:
## $lasso_bic
## (Intercept)        ICD1        NLP1          HU        ICD2        NLP2 
##  -5.3901962   1.9297295   1.2402141  -0.4471979   0.0000000   0.0000000 
##        NLP3 
##   0.9516273 
## 
## AUC on training data: 0.95 
## Average AUC on random splits: 0.938</code></pre>
<p>Validate phenotyping model using validation label, and show the AUC and ROC.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">validation &lt;-<span class="st"> </span><span class="kw">phecap_validate_phenotyping_model</span>(data, model)</a></code></pre></div>
<pre><code>## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to unique
## 'x' values

## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to unique
## 'x' values</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">validation</a></code></pre></div>
<pre><code>## AUC on validation data: 0.921 
## AUC on training data: 0.95 
## Average AUC on random splits: 0.938</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">round</span>(validation<span class="op">$</span>valid_roc[validation<span class="op">$</span>valid_roc[, <span class="st">&quot;FPR&quot;</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.2</span>, ], <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##       cutoff pos.rate   FPR   TPR   PPV   NPV    F1
##  [1,]  0.999    0.003 0.000 0.061 1.000 0.701 0.115
##  [2,]  0.969    0.100 0.009 0.308 0.939 0.759 0.464
##  [3,]  0.854    0.175 0.018 0.490 0.925 0.809 0.641
##  [4,]  0.680    0.194 0.027 0.584 0.907 0.837 0.710
##  [5,]  0.632    0.225 0.036 0.636 0.888 0.853 0.741
##  [6,]  0.596    0.253 0.050 0.700 0.864 0.874 0.773
##  [7,]  0.503    0.262 0.064 0.700 0.833 0.873 0.761
##  [8,]  0.461    0.269 0.073 0.700 0.814 0.872 0.753
##  [9,]  0.430    0.275 0.082 0.700 0.795 0.871 0.745
## [10,]  0.408    0.281 0.091 0.700 0.778 0.870 0.737
## [11,]  0.382    0.291 0.100 0.710 0.763 0.872 0.736
## [12,]  0.341    0.300 0.109 0.720 0.750 0.875 0.735
## [13,]  0.320    0.312 0.118 0.734 0.738 0.879 0.736
## [14,]  0.297    0.331 0.127 0.772 0.734 0.894 0.752
## [15,]  0.291    0.344 0.136 0.806 0.729 0.907 0.765
## [16,]  0.290    0.359 0.150 0.820 0.713 0.912 0.763
## [17,]  0.285    0.369 0.164 0.820 0.695 0.911 0.752
## [18,]  0.255    0.375 0.173 0.824 0.684 0.912 0.748
## [19,]  0.234    0.388 0.182 0.846 0.679 0.921 0.753
## [20,]  0.215    0.400 0.191 0.868 0.674 0.931 0.759
## [21,]  0.201    0.412 0.200 0.880 0.667 0.936 0.759</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">phecap_plot_roc_curves</span>(validation)</a></code></pre></div>
<pre><code>## Warning: Use of `df$value_x` is discouraged. Use `value_x` instead.</code></pre>
<pre><code>## Warning: Use of `df$value_y` is discouraged. Use `value_y` instead.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Apply the model to all the patients to obtain predicted phenotype.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">phenotype &lt;-<span class="st"> </span><span class="kw">phecap_predict_phenotype</span>(data, model)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">idx &lt;-<span class="st"> </span><span class="kw">which.min</span>(<span class="kw">abs</span>(validation<span class="op">$</span>valid_roc[, <span class="st">&quot;FPR&quot;</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">cut.fpr95 &lt;-<span class="st"> </span>validation<span class="op">$</span>valid_roc[idx, <span class="st">&quot;cutoff&quot;</span>]</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">case_status &lt;-<span class="st"> </span><span class="kw">ifelse</span>(phenotype<span class="op">$</span>prediction <span class="op">&gt;=</span><span class="st"> </span>cut.fpr95, <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">predict.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(phenotype, case_status)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">predict.table[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]</a></code></pre></div>
<pre><code>##    patient_id  prediction case_status
## 1           1 0.034377662           0
## 2           2 0.433139377           0
## 3           3 0.990857331           1
## 4           4 0.004233424           0
## 5           5 0.003442046           0
## 6           6 0.702835815           1
## 7           7 0.843285354           1
## 8           8 0.001620771           0
## 9           9 0.913644435           1
## 10         10 0.044409875           0</code></pre>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
